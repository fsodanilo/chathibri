<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>PDF + Chatbot RAG - Processamento de PDFs</title>
    <link rel="shortcut icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="/static/pdf_processor.css">
</head>
<body>
    <div class="sidebar-wrapper">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-title">
                    <span>üîç</span>
                    <span>PDF Processor</span>
                </div>
                <button class="toggle-btn" onclick="toggleSidebar()" id="toggle-btn"></button>
            </div>

            <div class="sidebar-content">
                <!-- Se√ß√£o: Voltar ao Chat -->
                <div class="sidebar-section">
                    <a href="/">
                        üè† Voltar ao Chat Principal
                    </a>
                    <p>Retornar √† interface de chat com PDFs</p>
                </div>

                <!-- Se√ß√£o: PDFs Armazenados -->
                <div class="sidebar-section">
                    <button class="section-toggle" onclick="toggleSection(this)">
                        <span>üìÅ</span>
                        <span>PDFs Armazenados</span>
                    </button>
                    <div class="section-body expanded">
                        {% if arquivos %}
                            {% for pdf in arquivos %}
                                <div style="padding: 8px 16px; margin: 4px 8px; background: #2a2a2a; border-radius: 6px; border-left: 3px solid #34a853;">
                                    <div style="font-size: 13px; color: #e3e3e3; font-weight: 500; margin-bottom: 2px;">
                                        {{ pdf.pdf_name if pdf.pdf_name else 'Nome n√£o dispon√≠vel' }}
                                    </div>
                                    <div style="font-size: 11px; color: #9aa0a6;">
                                        üìä {{ "{:,}".format(pdf.total_words).replace(',', '.') if pdf.total_words else 0 }} palavras
                                    </div>
                                </div>
                            {% endfor %}
                        {% else %}
                            <p>Nenhum PDF encontrado.</p>
                        {% endif %}
                    </div>
                </div>

                <!-- Se√ß√£o: Funcionalidades -->
                <div class="sidebar-section">
                    <button class="section-toggle" onclick="toggleSection(this)">
                        <span>‚öôÔ∏è</span>
                        <span>Funcionalidades</span>
                    </button>
                    <div class="section-body">
                        <p>‚Ä¢ Upload de novos PDFs</p>
                        <p>‚Ä¢ Extra√ß√£o autom√°tica de tabelas</p>
                        <p>‚Ä¢ Processamento com IA</p>
                        <p>‚Ä¢ Formato Delta Lake</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="main">
            <div class="content-container">
                <div class="content-area">
                    <div style="margin-bottom: 24px;">
                        <h1 style="color: #e3e3e3; margin: 0 0 8px 0; font-size: 28px; font-weight: 500;">üîç Processamento Avan√ßado de PDFs</h1>
                        <p style="color: #9aa0a6; margin: 0; font-size: 16px;">Extraia tabelas estruturadas de contratos e documentos PDF usando IA</p>
                    </div>

                    <!-- Se√ß√£o: Upload de Novos PDFs -->
                    <div class="section-card">
                        <h2>üìÑ Upload de Novo PDF</h2>
                        <p>Fa√ßa upload de um PDF para processamento avan√ßado com extra√ß√£o autom√°tica de tabelas</p>
                        
                        <div class="upload-area" id="uploadArea">
                            <div class="upload-icon">üìÅ</div>
                            <h3 style="color: #e3e3e3; margin: 16px 0 8px 0;">Arraste um arquivo PDF aqui ou clique para selecionar</h3>
                            <p style="color: #9aa0a6; margin: 0 0 20px 0;">Formatos aceitos: PDF (at√© 50MB)</p>
                            <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                                Selecionar Arquivo
                            </button>
                            <input type="file" id="fileInput" class="file-input" accept=".pdf" onchange="handleFileSelect(event)">
                        </div>
                        
                        <div id="selectedFile" style="display: none;">
                            <h4 style="color: #e3e3e3; margin: 20px 0 12px 0;">Arquivo Selecionado:</h4>
                            <div class="file-item">
                                <div class="file-info">
                                    <div class="file-name" id="fileName"></div>
                                    <div class="file-details" id="fileDetails"></div>
                                </div>
                                <button class="upload-btn" onclick="console.log('üîç DEBUG: Bot√£o clicado'); uploadFile()">
                                    üöÄ Processar PDF
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Se√ß√£o: Tabelas Delta -->
                    <div class="section-card">
                        <h2>üìä Tabelas Delta</h2>
                        <p>Visualize e gerencie as tabelas em formato Delta Lake geradas automaticamente</p>
                        
                        <div id="deltaTableDataSection" style="display: none;">
                        </div>
                    </div>

                    <!-- Loading -->
                    <div class="loading" id="loading">
                        <div class="spinner"></div>
                        <p id="loadingText" style="color: #e3e3e3; margin: 20px 0;">Processando...</p>
                        
                        <div class="progress-steps">
                            <div class="progress-step" id="step1">üì§ Upload</div>
                            <div class="progress-step" id="step2">üìÑ Extra√ß√£o</div>
                            <div class="progress-step" id="step3">ü§ñ IA</div>
                            <div class="progress-step" id="step4">üíæ Salvamento</div>
                            <div class="progress-step" id="step5">‚úÖ Completo</div>
                        </div>
                        
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="progress-text" id="progressText">Preparando...</div>
                    </div>

                    <!-- Resultados -->
                    <div id="results"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/pdf_processor.js"></script>
</body>
</html>
